# 유저 관리 프로그램 만들어보기
지난 시간에 배웠던 모든 걸 활용해서, 오늘은 유저 정보를 관리하는 프로그램 ㅡ 더 나아가서 게시판을 만들어보겠다.  
**콘솔 프로그램으로 만들 것이며, 웹으로 구현하는 것도 아니고 데이터베이스를 붙이지도 않고, 순수 Python만으로 한다는 점에 유의하라!**


### 무엇을 만들어야 할까? 요구사항 분석
프로그램을 만들려면 제일 먼저 기획, 즉 요구사항이 있어야 할 것 아닌가? 우리는 소비자의 요구사항을 어떠한 기능을 통해서 어떻게 프로그램으로 옮길 지 고민한다.

우리가 만들려는 유저 정보 관리 프로그램 ㅡ 이름은 무엇이든지 맘대로 해도 좋다 ㅡ 의 요구사항은 다음과 같다.

- 저장해야 하는 회원 정보는 다음과 같다.
  - 이름
  - 이메일
  - 나이
- 이메일과 패스워드를 사용해서 로그인할 수 있어야 한다.
- 회원가입을 할 수 있어야 한다.
- 매번 로그인하는걸 방지하기 위해서, 자동 로그인 기능을 만든다.
- \+ 회원 정보를 JSON으로 출력할 수 있게 해주세요. 패스워드는 빼고!!


이 요구사항을 어떻게 구현하면 좋을까? 다음과 같이 분석해 보았다.

- 회원 정보를 추상화한 User라는 클래스를 만들고...
  - 이 User들은 일단 리스트에다가 저장하자!
  - 새로운 회원이 추가되면 리스트 맨 뒤에 그냥 차례차례 저장하면 되고...
  - 로그인은 for-each문으로 돌면서 아이디 패스워드 일치여부를 따지면 될 것 같아!
      - 일일히 도는거 말고 더 빠르고 좋은 방법은 없을지 고민해보자
- 자동 로그인은 어떻게 할까?  
  - 로그인 / 회원가입 이후에 특별한 고유의 토큰 (Access Token)을 발급해서 용자의 컴퓨터에 저장해 놓자!
  - 다음번에 프로그램 실행시 사용자 컴퓨터에 Access Token이 저장되어 있으면 로그인 필요없이 자동으로 통과.


### 일단 간단하게, 돌아가는 코드를 구현해보기 - Prototyping

일단, 회원 정보 (User) 클래스를 만들어보자. 생성자를 이용해서 만드는 걸 권장한다. 이메일, 패스워드, 이름, 나이가 들어가있어야 한다.

```python
class User:
    def __init__(self, email, pw, name, age):
        self.email = email
        self.pw    = pw
        self.name  = name
        self.age   = age
```

user.py라는 이름으로 저장하자.

자, 이제 회원 정보 클래스도 만들었으니 한번 간단한 프로그램을 만들어보자!  
모범 답안은 [여기에](https://github.com/retail3210/python-server-for-aperture/tree/master/Lecture%203/Prototype)


### 코드 개선해보기
우리는 사용자로부터 입력받는 코드와, 유저를 저장하고 로그인하는 등의 의 코드를 한 곳에 코딩했다. **사용자로부터 입력받는 코드는 UI (사용자 인터페이스)** 라고 할 것이고, **유저를 저장하고 로그인하는 부분은 로직 (Logic)** 이라고 하자.

하지만, 실제 개발을 할 때 UI와 로직을 혼합해서 접근법은 좋지 않다.

- 둘의 속성은 다르다. 사용자로부터 입력을 받는 껍데기(UI)와, 그 본질 (로직)으로 나눌 수 있겠다.
- UI는 자주 바뀔 수 있는 반면 (ex: 갑님의 갈굼...), 로직은 잘 바뀌지 않는다.
  - UI는 플랫폼 (Windows, Mac, iOS...)마다 다르지만 로직은 같다.
- 한 사람이 코딩하면 괜찮다. 하지만 예를 들어 준성이가 UI를 코딩하고 욱재가 로직을 코딩한다고 하자.
  - UI와 로직이 한군데에 섞여 있으면 준성이와 욱재는 같은 파일을 건드려야 한다!
  - 그러다보면 코드가 꼬이고... 가정이 무너지고... 사회가 무너지고...
- UI는 UI대로 복잡해지고, 로직은 로직대로 복잡해지면 전체 코드는 너무나도 복잡해진다.

그럼 해결책은 무엇일까? 우린 지난 시간에 객체지향 프로그래밍을 배운 바 있다. **쪼개자!**  
해당 역할을 하는 객체를 사용해서 구조를 나눠보자.

![UML](https://raw.githubusercontent.com/retail3210/python-server-for-aperture/master/Lecture%203/lecture3-refactor-uml.png)

- **User** : 사용자 정보를 추상화한 클래스이다. 사용자 자체.
- **UserStore** : 사용자들의 정보를 저장하는 클래스이다.
- **UserManager** : 사용자를 관리 (로그인, 회원가입 등) 하는 클래스이다.
- 그리고 UI는, 별도의 usertest라는 모듈 (소스 파일)을 만들어서, *그곳에서 입력을 받고, UserManager의 로그인, 회원가입 함수를 호출하도록 하자.*

이런 식으로 코드의 구조와 품질을 개선하는 작업을 **Refactoring (리팩토링)** 이라고 한다.  
우리가 위처럼 했듯이, 실제로 실무에서 프로그램을 개발할 때에도 먼저 잘 작동하는 프로토타입을 빠르게 만들어서 사람들에게 먼저 보여주고, 피드백을 받아 제품을 개선하고, 이후에 리팩토링을 수행해서 오래가는 좋은 코드를 만드는 방법을 쓰는게 좋다. *첨언 : 애자일 (Agile) 방법론에 근거한 방법이다.*

모범 답안은 [여기에](https://github.com/retail3210/python-server-for-aperture/tree/master/Lecture%203/Refactored)


### GET READY FOR NEXT LECTURE:

- 자동 로그인
- 진짜 서버개발
